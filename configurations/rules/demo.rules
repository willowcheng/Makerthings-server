rule Away
when
	Item Presence changed to OFF
then
	Thread::sleep(3000)
	Light.send(OFF)
end

rule "Initialize contact states"
	when
		System started or
		Time cron "0/30 * * * * ?"
	then
		Windows?.members.forEach(window|
			window.postUpdate(if(Math::random > 0.5) OPEN else CLOSED)
		)
end

rule "Voice control"
	when
  	Item VoiceCommand received command
	then
		var String command = VoiceCommand.state.toString.toLowerCase
		logInfo("Voice.Rec","VoiceCommand received "+command)
		if (command.equals("open")) {
			Light_SF_Corridor_Ceiling.send(ON)
		} else if (command.equals("close")) {
			Light_SF_Corridor_Ceiling.send(OFF)
		}
end
